{% extends "base.html" %}
{% block title %}–ê—Ä—Ö—ñ–≤ –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤{% endblock %}

{% block content %}
<div class="container mx-auto p-6">
  <h1 class="text-3xl font-bold mb-6">üì¶ –ê—Ä—Ö—ñ–≤ –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤</h1>

  {% if archived_managers %}
    <div class="overflow-x-auto shadow-lg rounded-lg border border-gray-200">
      <table class="table w-full">
        <thead class="bg-gray-100 text-gray-800 text-sm uppercase">
          <tr>
            <th class="px-4 py-2">‚Ññ</th>
            <th class="px-4 py-2">–Ü–º º—è</th>
            <th class="px-4 py-2">–í—ñ–¥–¥—ñ–ª</th>
            <th class="px-4 py-2">–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è</th>
            <th class="px-4 py-2">–ü—Ä–æ–≥—Ä–µ—Å</th>
            <th class="px-4 py-2">–†—ñ—à–µ–Ω–Ω—è</th>
            <th class="px-4 py-2">–î–µ—Ç–∞–ª—ñ</th>
          </tr>
        </thead>
        <tbody>
          {% for manager, instance in archived_managers %}
            <tr class="hover:bg-gray-50 transition">
              <td class="px-4 py-2">{{ loop.index }}</td>
              <td class="px-4 py-2 font-semibold">{{ manager.username }}</td>
              <td class="px-4 py-2">{{ manager.department or "‚Äî" }}</td>
              <td class="px-4 py-2">{{ manager.created_at.strftime('%d.%m.%Y') }}</td>
              <td class="px-4 py-2">
                {% if instance.structure %}
                  {% set blocks = instance.structure if instance.structure is not string else instance.structure | from_json %}
                  <span class="badge badge-outline badge-info">
                    {{ instance.onboarding_step }}/{{ blocks | length }}
                  </span>
                {% else %}
                  ‚Äî
                {% endif %}
              </td>
              <td class="px-4 py-2">
                {% if instance.final_decision == 'approved' %}
                  <span class="badge badge-success">‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ</span>
                {% elif instance.final_decision == 'rejected' %}
                  <span class="badge badge-error">‚ùå –ù–µ –ø—Ä–æ–π–¥–µ–Ω–æ</span>
                {% else %}
                  <span class="badge badge-ghost">‚Äî</span>
                {% endif %}
              </td>
              <td class="px-4 py-2">
                <a href="{{ url_for('main.manager_results', manager_id=manager.id) }}"
                   class="btn btn-sm btn-outline btn-primary">
                  –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏
                </a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <p class="text-gray-500 mt-4">–ü–æ–∫–∏ —â–æ –∞—Ä—Ö—ñ–≤ –ø–æ—Ä–æ–∂–Ω—ñ–π.</p>
  {% endif %}
</div>
{% endblock %}