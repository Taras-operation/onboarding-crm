<!-- templates/archived_managers.html -->
{% extends "base.html" %}
{% block title %}–ê—Ä—Ö—ñ–≤ –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤{% endblock %}

{% block content %}
<div class="container mx-auto p-6">
  <h1 class="text-4xl font-bold mb-6 flex items-center gap-2">
    üì¶ –ê—Ä—Ö—ñ–≤ –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤
  </h1>

  {% if archived_managers %}
    <div class="overflow-x-auto shadow-xl rounded-lg bg-white">
      <table class="table w-full">
        <thead class="bg-base-200 text-base font-semibold text-gray-800">
          <tr>
            <th>‚Ññ</th>
            <th>–Ü–º‚Äô—è</th>
            <th>–í—ñ–¥–¥—ñ–ª</th>
            <th>–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è</th>
            <th>–ü—Ä–æ–≥—Ä–µ—Å</th>
            <th>–†—ñ—à–µ–Ω–Ω—è</th>
            <th>–î—ñ—ó</th>
          </tr>
        </thead>
        <tbody>
          {% for manager in archived_managers %}
            {% set instance = manager.onboarding_instances[-1] if manager.onboarding_instances else None %}
            <tr class="hover">
              <td>{{ loop.index }}</td>
              <td>{{ manager.username }}</td>
              <td>{{ manager.department or "‚Äî" }}</td>
              <td>{{ manager.created_at.strftime('%d.%m.%Y') }}</td>
              <td>
                {% if instance %}
                  –ü—Ä–æ–π–¥–µ–Ω–æ {{ instance.onboarding_step }}/{{ instance.structure|length }}
                {% else %}
                  ‚Äî
                {% endif %}
              </td>
              <td>
                {% if instance %}
                  {% if instance.final_decision == 'approved' %}
                    <span class="badge badge-success">‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ</span>
                  {% elif instance.final_decision == 'rejected' %}
                    <span class="badge badge-error">‚ùå –ù–µ –ø—Ä–æ–π–¥–µ–Ω–æ</span>
                  {% else %}
                    <span class="badge badge-neutral">‚Äî</span>
                  {% endif %}
                {% else %}
                  <span class="badge badge-neutral">‚Äî</span>
                {% endif %}
              </td>
              <td>
                {% if instance %}
                  <a href="{{ url_for('main.manager_results', manager_id=manager.id) }}"
                     class="btn btn-xs btn-outline btn-primary">
                    –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏
                  </a>
                {% else %}
                  <span class="text-gray-400 text-sm">–ù–µ–º–∞—î</span>
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="p-4 bg-yellow-50 border border-yellow-200 text-yellow-800 rounded-md">
      –ü–æ–∫–∏ —â–æ –∞—Ä—Ö—ñ–≤ –ø–æ—Ä–æ–∂–Ω—ñ–π.
    </div>
  {% endif %}
</div>
{% endblock %}